"""Reads save file to a list and returns the list"""
def readBytes(file):
    bytes = []
    with open(file, 'rb') as hexFile:
        while True:
            byte = hexFile.read(1)
            if not byte:
                break
            bytes.append(int.from_bytes(byte, byteorder='little'))
    
    return bytes

"""Writes the byte list to the save file"""
def writeBytes(file, bytes):
    with open(file, 'wb') as hexFile:
        for ints in bytes:
            hexFile.write(ints.to_bytes(1, byteorder='little'))

"""Gets input to change stats and checks for range boundaries"""
def getInput(byte_size):
    byte_values = []
    value1 = value2 = 0
    bytes = ""
    byte1 = byte2 = "0x"

    if byte_size == 1:
        user_input = input("Enter a stat/value between 0 and 255: ")
        user_stat = int(user_input)

        if user_stat > 255 and user_stat < 0:
            user_stat = 255
        
        byte_values.append(user_stat)
    """If byte size equal 2, convert int to hex then split in half, and order them in little endian"""
    if byte_size == 2:
        user_input = input("Enter a stat/value between 0 and 65535: ")
        user_stat = int(user_input)

        if user_stat > 65535 and user_stat < 0:
            user_stat = 65535
        
        """Converts user_stat into a hex with padded 0's if necessary"""
        bytes = "{0:#0{1}x}".format(user_stat, 6)
        byte1 += bytes[2] + bytes[3]
        byte2 += bytes[4] + bytes[5]

        """Converts the hex into a decimal"""
        value1 = int(byte1, 16)
        value2 = int(byte2, 16)

        """Add the converted hex values into list"""
        byte_values.append(value2)
        byte_values.append(value1)
    
    return byte_values

def main():
    filename = 'SAVED.GAM'
    bytes = readBytes(filename)
    terminate = False
    new_stats = []

    """Menu loop to change stats/values until terminated"""
    while not terminate:
        key = input("Select a stat or item to change:\n1) Strength\n2) Dexterity\n3) Intelligence\n4) Good HP\n5) Max HP\n6) EXP\n7) Gold\n8) Keys\n9) Skull keys\n10) Gems\n11) Black Badge\n12) Magic Carpet\n13) Magic Axes\nAny other key) Terminate program\n")

        """Cases for stats/items"""
        if key == "1":
            """Changing Strength for all characters"""
            new_stats = getInput(1)
            for i in range(2, 483,32):
                bytes[i+12] = new_stats[0]
        elif key == "2":
            """Changing Dexterity for all characters"""
            new_stats = getInput(1)
            for i in range(2, 483,32):
                bytes[i+13] = new_stats[0]
        elif key == "3":
            """Changing Intelligence for all characters"""
            new_stats = getInput(1)
            for i in range(2, 483,32):
                bytes[i+14] = new_stats[0]
        elif key == "4":
            """Changing Good HP for all characters"""
            new_stats = getInput(2)
            for i in range(2, 483,32):
                bytes[i+16] = new_stats[0]
                bytes[i+17] = new_stats[1]
        elif key == "5":
            """Changing Max HP for all characters"""
            new_stats = getInput(2)
            for i in range(2, 483,32):
                bytes[i+18] = new_stats[0]
                bytes[i+19] = new_stats[1]
        elif key == "6":
            """Changing EXP for all characters"""
            new_stats = getInput(2)
            for i in range(2, 483,32):
                bytes[i+20] = new_stats[0]
                bytes[i+21] = new_stats[1]
        elif key == "7":
            """Changing Gold"""
            new_stats = getInput(2)
            bytes[516] = new_stats[0]
            bytes[517] = new_stats[1]
        elif key == "8":
            """Changing keys"""
            new_stats = getInput(1)
            bytes[518] = new_stats[0]
        elif key == "9":
            """Changing skull keys"""
            new_stats = getInput(1)
            bytes[523] = new_stats[0]
        elif key == "10":
            """Changing gems"""
            new_stats = getInput(1)
            bytes[519] = new_stats[0]
        elif key == "11":
            """Changing Black Badge"""
            new_stats = getInput(1)
            bytes[536] = new_stats[0]
        elif key == "12":
            """Changing Magic Carpet"""
            new_stats = getInput(1)
            bytes[522] = new_stats[0]
        elif key == "13":
            """Changing Magic Axe"""
            new_stats = getInput(1)
            bytes[576] = new_stats[0]
        else:
            print("Data changing has now stopped")
            terminate = True
        
    writeBytes(filename, bytes)
main()
